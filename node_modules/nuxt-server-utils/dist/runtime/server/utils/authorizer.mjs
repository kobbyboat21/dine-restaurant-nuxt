import { createError } from "h3";
class Authorizer {
  /**
   * Gate
   * @param event
   * @param fn
   * @param error
   * @returns
   */
  allows(event, fn, error = {
    status: 403,
    statusText: "Forbidden"
  }) {
    if (!fn()) {
      throw createError(error);
    }
    return;
  }
}
export default new Authorizer();
